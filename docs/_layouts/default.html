<!DOCTYPE html>
{% assign lang = site.data.translations | where_exp:"item", "item.slug == page.lang" | first %}
<html lang="{{ lang.slug }}">
{% assign losses = site.data.russian-losses %}
{% assign current = losses | slice: 0 | first %}
{% assign previous = losses | slice: 1 | first %}
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ lang.title }}</title>
    <meta name="robots" content="index, follow">
    <meta name="description" content="{{ lang.description }}">
    <meta name="keywords" content="{{ lang.keywords }}">
    <meta name="revised" content="{{ current.date }}">
    <meta name="theme-color" content="#0056B9">
    <meta http-equiv="Cache-Control" content="max-age=28800">
    <link rel="alternate" hreflang="en-us" href="https://www.ukrainewarlosses.com">
    <link rel="alternate" hreflang="en-gb" href="https://www.ukrainewarlosses.com/uk">
    <link rel="alternate" hreflang="fr" href="https://www.ukrainewarlosses.com/fr">
    <link rel="alternate" hreflang="de" href="https://www.ukrainewarlosses.com/de">
    <link rel="alternate" hreflang="uk" href="https://www.ukrainewarlosses.com/ua">
    <link rel="alternate" hreflang="ru" href="https://www.ukrainewarlosses.com/ru">

    <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png">
    <link rel="apple-touch-icon" type="image/png" sizes="167x167" href="/favicon-167x167.png">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/favicon-180x180.png">

    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ lang.title }}">
    <meta property="og:description" content="{{ lang.description }}">
    <meta property="og:url" content="https://www.ukrainewarlosses.com{{ page.url }}">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F1BE3PCJV2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-F1BE3PCJV2');
    </script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" rel="stylesheet"
        crossorigin="anonymous" referrerpolicy="no-referrer">
    <link href="/css/site.css" rel="stylesheet">
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg bg-ua-blue sticky-top text-white">
            <div class="container" aria-label="Main navigation">
                <span class="navbar-brand p-0 me-0 me-lg-2 text-white" aria-label="Orc Losses">
                    <iconify-icon icon="game-icons:orc-head" class="fs-3"></iconify-icon>
                </span>

                <button class="navbar-toggler p-2 text-white border-white" type="button" data-bs-toggle="collapse"
                    data-bs-target="#primary-navigation-menu" aria-controls="primary-navigation-menu"
                    aria-label="Toggle docs navigation">
                    <iconify-icon icon="radix-icons:hamburger-menu"></iconify-icon>
                </button>

                <div id="primary-navigation-menu" class="collapse navbar-collapse">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-text d-none d-lg-inline-block">
                            {{ lang.page-title }}
                        </li>
                    </ul>
                    <ul class="navbar-nav d-flex">
                        <li class="nav-item dropdown">
                            <a id="theme-menu-toggle" class="nav-link dropdown-toggle text-white" href="#" role="button"
                                aria-haspopup="true" aria-controls="theme-menu" aria-label="{{ lang.theme-label }}"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <iconify-icon class="me-1 align-middle"
                                    icon="material-symbols:light-mode"></iconify-icon>
                                {{ lang.theme-label }}
                            </a>
                            <ul id="theme-menu" class="dropdown-menu" role="menu" aria-labelledby="theme-menu-toggle">
                                <li role="menuitem" onclick="togglePageTheme('light')">
                                    <span class="dropdown-item">
                                        <iconify-icon icon="material-symbols:light-mode"
                                            role="presentation"></iconify-icon>
                                        {{ lang.theme-light-label }}
                                    </span>
                                </li>
                                <li role="menuitem" onclick="togglePageTheme('dark')">
                                    <span class="dropdown-item">
                                        <iconify-icon icon="material-symbols:dark-mode"
                                            role="presentation"></iconify-icon>
                                        {{ lang.theme-dark-label }}
                                    </span>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item col-12 col-lg-auto text-white py-2 py-lg-1">
                            <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-white-50"></div>
                            <hr class="d-lg-none my-2 text-white-50">
                        </li>
                        <li class="nav-item dropdown">
                            <a id="language-menu-toggle" class="nav-link dropdown-toggle text-white" href="#"
                                role="button" aria-haspopup="true" aria-controls="language-menu"
                                aria-label="{{ lang.language-label }}" data-bs-toggle="dropdown" aria-expanded="false">
                                {% if lang.slug == "en-GB" %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:uk"
                                    role="presentation"></iconify-icon>
                                {% elsif lang.slug == "fr-FR" %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:fr"
                                    role="presentation"></iconify-icon>
                                {% elsif lang.slug == "de-DE" %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:de"
                                    role="presentation"></iconify-icon>
                                {% elsif lang.slug == "uk-UA" %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:ua"
                                    role="presentation"></iconify-icon>
                                {% elsif lang.slug == "ru-RU" %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:ru"
                                    role="presentation"></iconify-icon>
                                {% else %}
                                <iconify-icon class="me-1 align-middle" icon="circle-flags:us"></iconify-icon>
                                {% endif %}
                                {{ lang.language-label }}
                            </a>
                            <ul id="language-menu" class="dropdown-menu" role="menu"
                                aria-labelledby="language-menu-toggle">
                                <li role="presentation">
                                    <a role="menuitem" href="/" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:us" role="presentation"></iconify-icon>
                                        English (US)
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" href="/uk" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:uk" role="presentation"></iconify-icon>
                                        English (UK)
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" href="/fr" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:fr" role="presentation"></iconify-icon>
                                        Français
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" href="/de" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:de" role="presentation"></iconify-icon>
                                        Deutsch
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" href="/ua" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:ua" role="presentation"></iconify-icon>
                                        Українська
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" href="/ru" class="dropdown-item">
                                        <iconify-icon icon="circle-flags:ru" role="presentation"></iconify-icon>
                                        Русский
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="container pt-3" aria-live="polite">
        <section class="mb-4">
            <p>{{ lang.preamble-paragraph }}</p>

            {{ content }}
        </section>

        <div class="row">
            <div class="col-xl-9">
                <section id="losses-container" class="mb-4">
                    <div class="row">
                        {% for category in site.data.categories %}
                            <div class="col-12 col-md-6 col-xxl-4 mb-3">
                                <div class="d-flex flex-column justify-content-between p-3 h-100 border border-1">
                                    <div class="d-flex justify-content-between">
                                        <h3>{{ lang[category.label] }}</h3>
                                        <img class="icon light mx-1" title="{{ lang[category.label] }}" src="icon/{{ category.icon }}.png" aria-hidden="true">
                                        <img class="icon dark mx-1" title="{{ lang[category.label] }}" src="icon/{{ category.icon }}-white.png" aria-hidden="true">
                                    </div>
                                    {% assign diff = current[category.key] | minus: previous[category.key] %}
                                    <p class="text-center my-0" aria-describedby="losses-{{ category.id }}-description">
                                        {% if category.id == "personnel"  %}~{% endif %}<span class="localizable-number">{{ current[category.key] }}</span>
                                        {% if diff > 0 %}
                                            +(<span class="localizable-number">{{ diff }}</span>)
                                        {% endif %}
                                    </p>
                                    <p id="losses-{{ category.id }}-description" class="visually-hidden">
                                        {% if category.id == "personnel"  %}~{% endif %}<span class="localizable-number">{{ current[category.key] }}</span>
                                        {{ lang[category.label]}} {{ lang.lost-since-label }} 2022.
                                    </p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </section>

                <section id="charts-container" class="mb-4">
                    <div class="chart-container">
                        <div id="line-chart" class="line-chart">
                            Loading chart...
                        </div>
                    </div>
                </section>
            </div>
            <div class="col-xl-3">
                <div class="border border-1 rounded mb-4 p-3">
                    <section id="open-source-disclaimer-container">
                        <h4>
                            <iconify-icon class="fs-3 align-middle" icon="arcticons:ukraine-tryzub"></iconify-icon>
                            {{ lang.os-open-data }}
                        </h4>
                        <p>
                            {{ lang.os-disclaimer-p1-1 }}
                            <a href="https://mod.gov.ua" title="{{ lang.ua-min-def }}" target="_blank"
                                rel="noopener noreferrer">{{ lang.ua-min-def }}</a>.
                            {{ lang.os-disclaimer-p1-2 }}
                        </p>
                        <p>
                            {{ lang.os-disclaimer-p2-1 }}
                            <a href="https://www.github.com/lod-db/orc-losses" title="Orc Losses on GitHub"
                                target="_blank" rel="noopener">GitHub</a>
                            {{ lang.os-disclaimer-p2-2 }}
                        </p>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <footer class="border-top border-1">
        <div class="container d-flex justify-content-between">
            <div>
                <p class="m-0">
                    <iconify-icon icon="mdi:github" class="me-1 align-middle fs-4"></iconify-icon>
                    <span class="d-inline-block pt-1">{{ lang.view-on-github-label }}</span>
                    <a class="btn btn-link px-0" href="https://www.github.com/lod-db/orc-losses"
                        title="Orc Losses on GitHub" target="_blank" rel="noopener">GitHub</a>
                </p>
            </div>
            <div>
                <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#modal-tos">{{
                    lang.tos-label }}</button>
                <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#modal-attribution">{{
                    lang.attributions-label }}</button>
            </div>
        </div>
    </footer>

    <div id="modal-tos" class="modal fade" tabindex="-1" aria-labelledby="modal-tos-title" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="modal-tos-title" class="modal-title fs-5">{{ lang.tos-label }}</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {% include tos.html %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Understood</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-attribution" class="modal fade" tabindex="-1" aria-labelledby="modal-attribution-title"
        aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="modal-attribution-title" class="modal-title fs-5">{{ lang.attributions-label }}</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {% include attribution.html %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme Toggle
        let theme = 'light';
        function togglePageTheme(t, save = true) {
            theme = t;
            const htmlEle = document.getElementsByTagName('html')[0];
            const toggleEle = document.getElementById('theme-menu-toggle');
            const iconEle = toggleEle.querySelector('iconify-icon');

            htmlEle.setAttribute('data-bs-theme', theme);
            iconEle.setAttribute('icon', `material-symbols:${theme}-mode`);

            if (save) {
                localStorage.setItem('theme', theme);
            }

            try { initLineChart() } catch (err) { }
        }

        (function () {
            theme = localStorage.getItem('theme');
            const isDarkTheme = theme
                ? theme === 'dark'
                : window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

            if (isDarkTheme) {
                togglePageTheme('dark', false);
            }
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"
        integrity="sha512-k37wQcV4v2h6jgYf5IUz1MoSKPpDs630XGSmCaCCOXxy2awgAWKHGZWr9nMyGgk3IOxA1NxdkN8r1JHgkUtMoQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Set Globals
        const locale = '{{ lang.slug }}';
        const charts = {};
        const lossesDict = {};
        const lossesSorted = (function () {
            const json = {{ losses | jsonify }}
            const lossesSorted = json.toSorted((a, b) => a.date.localeCompare(b.date, 'en'));

            for (const loss of lossesSorted) {
                lossesDict[loss.date] = loss;
            }

            return lossesSorted;
        })();
        const dateRange = (function () {
            // Date constructor w/o time sets underlying date in UTC. Adding time keeps it local
            let date = new Date(lossesSorted[0].date + 'T00:00:00');
            const dateToday = new Date(lossesSorted[lossesSorted.length - 1].date + 'T00:00:00');
            const dateRange = [];
            while (date <= dateToday) {
                const dateKey = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
                dateRange.push(dateKey);

                date = new Date(date.getTime() + 86400000);
            };

            return dateRange;
        })();
        const isNull = (val) => typeof val === 'undefined' || val === null;
    </script>
    <script>
        // Localize numbers, this is the recommend approach with Liquid
        (function () {
            const numberEles = document.getElementsByClassName("localizable-number");
            Array.from(numberEles).forEach(e => {
                const text = e.innerText;
                const num = parseInt(text);
                const localized = !isNaN(num) ? num.toLocaleString(locale) : '';

                e.innerText = localized;
            });
        })();
    </script>
    <script>
        // Create Line Chart
        function initLineChart() {
            if (charts['line']) {
                charts['line'].dispose();
            }

            const markArea = {
                itemStyle: {
                    color: 'rgba(225, 225, 225, 0.4)'
                },
                data: [],
            };

            function createLineSeries(data) {
                const dataPoints = [
                    {
                        name: '{{ lang.personnel-label }}',
                        data: data.map(d => d?.personnel),
                    },
                    {
                        name: '{{ lang.tanks-label }}',
                        data: data.map(d => d?.tanks),
                    },
                    {
                        name: '{{ lang.afvs-label }}',
                        data: data.map(d => d?.afvs),
                    },
                    {
                        name: '{{ lang.artillery-label }}',
                        data: data.map(d => d?.artillery),
                    },
                    {
                        name: '{{ lang.aa-label }}',
                        data: data.map(d => d?.airDefense),
                    },
                    {
                        name: '{{ lang.mlrs-label }}',
                        data: data.map(d => d?.rocketSystems),
                    },
                    {
                        name: '{{ lang.vehicles-label }}',
                        data: data.map(d => d?.unarmoredVehicles),
                    },
                    {
                        name: '{{ lang.jets-label }}',
                        data: data.map(d => d?.fixedWingAircraft),
                    },
                    {
                        name: '{{ lang.helicopters-label }}',
                        data: data.map(d => d?.rotaryWingAircraft),
                    },
                    {
                        name: '{{ lang.uavs-label }}',
                        data: data.map(d => d?.uavs),
                    },
                    {
                        name: '{{ lang.ships-label }}',
                        data: data.map(d => d?.ships),
                    },
                    {
                        name: '{{ lang.submarines-label }}',
                        data: data.map(d => d?.submarines),
                    },
                    {
                        name: '{{ lang.special-label }}',
                        data: data.map(d => d?.specialEquipment),
                    },
                    {
                        name: '{{ lang.missiles-label }}',
                        data: data.map(d => d?.missiles),
                    },
                ];
                const items = dataPoints.map((d, i) => ({
                    type: 'line',
                    name: d.name,
                    data: d.data,
                    connectNulls: true,
                    markArea: i === 0 ? markArea : {},
                    stack: 'Total',
                    areaStyle: {},
                    emphasis: {
                        focus: 'series',
                    },
                    label: {
                        show: true,
                        position: 'top',
                    },
                }));

                return items;
            }

            const series = createLineSeries(dateRange.map((d) => lossesDict[d]));

            const lineChart = echarts.init(document.getElementById('line-chart'), theme);
            markArea.data = [
                // [
                //     {
                //         name: 'Battle of Kyiv',
                //         // This started 2022-02-25 but data starts 2022-02-27
                //         xAxis: '2022-02-27',
                //     },
                //     {
                //         xAxis: '2022-04-02',
                //     },
                // ],
                // [
                //     {
                //         name: 'Battle of Bakhmut',
                //         xAxis: '2022-06-03',
                //     },
                //     {
                //         xAxis: '2023-05-20',
                //     },
                // ],
                // [
                //     {
                //         name: 'Kharkiv Counteroffensive',
                //         xAxis: '2022-09-06',
                //     },
                //     {
                //         xAxis: '2022-10-01',
                //     },
                // ],
                // [
                //     {
                //         name: 'Kharkiv Counteroffensive',
                //         xAxis: '2022-09-06',
                //     },
                //     {
                //         xAxis: '2022-10-01',
                //     },
                // ],
            ];
            const lineChartOptions = {
                title: {
                    //text: 'Russian Losses in Ukraine',
                    subtext: `2022 - ${new Date(lossesSorted[lossesSorted.length - 1].date).getFullYear()}`,
                    left: 'center',
                },
                darkMode: 'auto',
                series,
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#6a7985',
                        },
                    },
                },
                legend: {
                    type: 'scroll',
                    orient: 'vertical',
                    left: 15,
                    top: 75,
                    bottom: 20,
                    show: false,
                },
                toolbox: {
                    show: true,
                    feature: {
                        dataZoom: {
                            yAxisIndex: 'none',
                        },
                        dataView: {
                            readOnly: true,
                        },
                        restore: {},
                        saveAsImage: {},
                    },
                },
                dataZoom: [
                    {
                        type: 'inside',
                        xAxisIndex: [0],
                        start: 0,
                        end: 100,
                    },
                    {
                        type: 'slider',
                        yAxisIndex: [0],
                        start: 0,
                        end: 100,
                    },
                ],
                grid: {
                    left: '3%',
                    right: '3%',
                    bottom: '3%',
                    containLabel: true,
                },
                xAxis: [
                    {
                        type: 'category',
                        boundaryGap: false,
                        data: dateRange,
                    },
                ],
                yAxis: [
                    {
                        type: 'value',
                    },
                ],
            };

            lineChartOptions && lineChart.setOption(lineChartOptions);

            charts['line'] = lineChart;
        };
        initLineChart();
    </script>
</body>

</html>
